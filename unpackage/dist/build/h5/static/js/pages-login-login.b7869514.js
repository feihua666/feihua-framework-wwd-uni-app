(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-login-login"],{4021:function(e,n,t){"use strict";var r=t("5eb0"),i=t.n(r);i.a},"429f":function(e,n,t){"use strict";t.r(n);var r=t("d8f1"),i=t.n(r);for(var o in r)"default"!==o&&function(e){t.d(n,e,function(){return r[e]})}(o);n["default"]=i.a},"43aa":function(e,n,t){"use strict";e.exports={error:"",check:function(e,n){for(var t=0;t<n.length;t++){if(!n[t].checkType)return!0;if(!n[t].name)return!0;if(!n[t].errorMsg)return!0;if(!e[n[t].name])return this.error=n[t].errorMsg,!1;switch(n[t].checkType){case"string":var r=new RegExp("^.{"+n[t].checkRule+"}$");if(!r.test(e[n[t].name]))return this.error=n[t].errorMsg,!1;break;case"int":r=new RegExp("^(-[1-9]|[1-9])[0-9]{"+n[t].checkRule+"}$");if(!r.test(e[n[t].name]))return this.error=n[t].errorMsg,!1;break;case"between":if(!this.isNumber(e[n[t].name]))return this.error=n[t].errorMsg,!1;var i=n[t].checkRule.split(",");if(i[0]=Number(i[0]),i[1]=Number(i[1]),e[n[t].name]>i[1]||e[n[t].name]<i[0])return this.error=n[t].errorMsg,!1;break;case"betweenD":r=/^-?[1-9][0-9]?$/;if(!r.test(e[n[t].name]))return this.error=n[t].errorMsg,!1;i=n[t].checkRule.split(",");if(i[0]=Number(i[0]),i[1]=Number(i[1]),e[n[t].name]>i[1]||e[n[t].name]<i[0])return this.error=n[t].errorMsg,!1;break;case"betweenF":r=/^-?[0-9][0-9]?.+[0-9]+$/;if(!r.test(e[n[t].name]))return this.error=n[t].errorMsg,!1;i=n[t].checkRule.split(",");if(i[0]=Number(i[0]),i[1]=Number(i[1]),e[n[t].name]>i[1]||e[n[t].name]<i[0])return this.error=n[t].errorMsg,!1;break;case"same":if(e[n[t].name]!=n[t].checkRule)return this.error=n[t].errorMsg,!1;break;case"notsame":if(e[n[t].name]==n[t].checkRule)return this.error=n[t].errorMsg,!1;break;case"email":r=/^\w+([-+.']\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/;if(!r.test(e[n[t].name]))return this.error=n[t].errorMsg,!1;break;case"phoneno":r=/^1[0-9]{10,10}$/;if(!r.test(e[n[t].name]))return this.error=n[t].errorMsg,!1;break;case"zipcode":r=/^[0-9]{6}$/;if(!r.test(e[n[t].name]))return this.error=n[t].errorMsg,!1;break;case"reg":r=new RegExp(n[t].checkRule);if(!r.test(e[n[t].name]))return this.error=n[t].errorMsg,!1;break;case"in":if(-1==n[t].checkRule.indexOf(e[n[t].name]))return this.error=n[t].errorMsg,!1;break;case"notnull":if(null==e[n[t].name]||e[n[t].name].length<1)return this.error=n[t].errorMsg,!1;break}}return!0},isNumber:function(e){var n=/^-?[1-9][0-9]?.?[0-9]*$/;return n.test(e)},checkForm:function(e,n){var t=this.check(e,n);return!!t||(uni.showToast({title:this.error,icon:"none"}),!1)}}},5530:function(e,n,t){"use strict";var r=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("v-uni-view",{staticClass:"uni-column uni-flex uni-flex-item "},[t("v-uni-view",{staticClass:"uni-input-group"},[t("v-uni-view",{staticClass:"uni-input-row"},[t("v-uni-text",{staticClass:"uni-label"},[e._v("账号：")]),t("v-uni-input",{attrs:{type:"text",focus:"",placeholder:"请输入账号"},model:{value:e.form.principal,callback:function(n){e.$set(e.form,"principal",n)},expression:"form.principal"}})],1),t("v-uni-view",{staticClass:"uni-input-row"},[t("v-uni-text",{staticClass:"uni-label"},[e._v("密码：")]),t("v-uni-input",{attrs:{type:"password",placeholder:"请输入密码"},model:{value:e.form.password,callback:function(n){e.$set(e.form,"password",n)},expression:"form.password"}})],1)],1),t("v-uni-view",{staticClass:"fh-padding-30"},[t("v-uni-button",{attrs:{type:"primary",loading:e.loginLoading},on:{click:function(n){n=e.$handleEvent(n),e.loginBtnClick(n)}}},[e._v("登录")])],1),t("v-uni-view",{staticClass:"uni-row uni-flex fh-padding-30 fh-justify-content-center"},[t("v-uni-navigator",{staticClass:"uni-link",attrs:{url:"/pages/regist/regist"}},[e._v("注册账号")]),t("v-uni-text",[e._v("|")]),t("v-uni-navigator",{staticClass:"uni-link",attrs:{url:"/pages/password/forget"}},[e._v("忘记密码")])],1),t("v-uni-view",{staticClass:"uni-row uni-flex fh-padding-30 fh-justify-content-center"},[t("v-uni-button",{attrs:{type:"primary",size:"mini"},on:{click:function(n){n=e.$handleEvent(n),e.wxLoginBtnClick(n)}}},[e._v("微信直接登录")])],1)],1)},i=[];t.d(n,"a",function(){return r}),t.d(n,"b",function(){return i})},"5eb0":function(e,n,t){var r=t("7cb6");"string"===typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);var i=t("4f06").default;i("20d5b871",r,!0,{sourceMap:!1,shadowMode:!1})},"7cb6":function(e,n,t){n=e.exports=t("2350")(!1),n.push([e.i,".uni-input-row .uni-label[data-v-6a4b7062]{width:26%}.uni-input-row uni-input[data-v-6a4b7062]{width:100%}",""])},"9d5b":function(e,n,t){"use strict";t.r(n);var r=t("5530"),i=t("429f");for(var o in i)"default"!==o&&function(e){t.d(n,e,function(){return i[e]})}(o);t("4021");var a=t("2877"),s=Object(a["a"])(i["default"],r["a"],r["b"],!1,null,"6a4b7062",null);n["default"]=s.exports},d8f1:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=a(t("a34a")),i=t("2f62"),o=a(t("43aa"));function a(e){return e&&e.__esModule?e:{default:e}}function s(e,n,t,r,i,o,a){try{var s=e[o](a),u=s.value}catch(c){return void t(c)}s.done?n(u):Promise.resolve(u).then(r,i)}function u(e){return function(){var n=this,t=arguments;return new Promise(function(r,i){var o=e.apply(n,t);function a(e){s(o,r,i,a,u,"next",e)}function u(e){s(o,r,i,a,u,"throw",e)}a(void 0)})}}function c(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.forEach(function(n){l(e,n,t[n])})}return e}function l(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}var f={components:{},data:function(){return{positionTop:0,loginLoading:!1,form:{loginType:"ACCOUNT",loginClient:"h5",principal:"",password:"",captcha:"",rememberMe:!1},wxLoginForm:{loginType:"WX_PLATFORM",loginClient:"h5",type:this.$config.which,rememberMe:!1}}},onBackPress:function(){if(!this.hasLogin&&this.$config.forcedLogin)return!0},computed:(0,i.mapState)(["hasLogin"]),methods:c({},(0,i.mapMutations)(["setGlobalDataInit"]),{loginBtnClick:function(){if(this.checkLoginForm()){var e=this;e.loginLoading=!0,this.$http.post("/login",{data:this.form,checkLogin:!1,success:function(){var n=u(r.default.mark(function n(t){return r.default.wrap(function(n){while(1)switch(n.prev=n.next){case 0:e.loginLoading=!1,e.loginSuccess();case 2:case"end":return n.stop()}},n,this)}));function t(e){return n.apply(this,arguments)}return t}(),fail:function(n){var t=n.statusCode;401==t?uni.showToast({title:"用户名或密码错误",icon:"none"}):400==t&&n.data.data.code,e.loginLoading=!1}})}},wxLoginAuto:function(){var e=this;this.$http.post("/login",{data:this.wxLoginForm,checkLogin:!1,success:function(n){uni.setStorage({key:"wxLoginAuto",data:!0}),e.loginSuccess()},fail:function(e){uni.showToast({title:"登录失败",icon:"none"})},complete:function(){uni.removeStorage({key:"wxLogin"})}})},loginSuccess:function(){uni.showToast({title:"登录成功",icon:"none",duration:1e3});var e=this;e.$http.initGobalData(!0,function(){e.navigateBack()})},navigateBack:function(){var e=getCurrentPages();e&&e.length>1?uni.navigateBack({delta:1}):uni.reLaunch({url:"/pages/index/index"})},checkLoginForm:function(){var e=[{name:"principal",checkType:"notnull",checkRule:"",errorMsg:"请输入帐号"},{name:"password",checkType:"notnull",checkRule:"",errorMsg:"请输入密码"}],n=o.default.checkForm(this.form,e);return n},wxLoginBtnClick:function(){var e=this;e.$http.get("/publicplatform/authAuthorizePageUrl/"+e.$config.which,{data:{scope:"snsapi_userinfo",state:"STATE",redirectUrl:e.$config.hostApi+"/publicplatform/getAuthUserInfo/"+e.$config.which+"?redirectUrl="+e.$config.host+"/uni-app"},success:function(e){var n=e.data.data.content;uni.setStorageSync("wxLogin",!0),window.location.href=n}})}}),watch:{},onLoad:function(e){console.log("onLoad login"),!this.hasLogin&&uni.getStorageSync("wxLogin")?this.wxLoginAuto():!this.hasLogin&&uni.getStorageSync("wxLoginAuto")&&this.wxLoginBtnClick()}};n.default=f}}]);