(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-activity-pay"],{"25d5":function(t,e,i){"use strict";i.r(e);var a=i("dbdd"),n=i.n(a);for(var c in a)"default"!==c&&function(t){i.d(e,t,function(){return a[t]})}(c);e["default"]=n.a},3473:function(t,e,i){var a=i("4c6d");"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var n=i("4f06").default;n("78754be7",a,!0,{sourceMap:!1,shadowMode:!1})},4722:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=function(t,e){WeixinJSBridge.invoke("getBrandWCPayRequest",{appId:t.appId,timeStamp:t.timeStamp,nonceStr:t.nonceStr,package:t.package,signType:t.signType,paySign:t.paySign},function(t){e(t)})};"undefined"==typeof WeixinJSBridge&&(document.addEventListener?document.addEventListener("WeixinJSBridgeReady",a,!1):document.attachEvent&&(document.attachEvent("WeixinJSBridgeReady",a),document.attachEvent("onWeixinJSBridgeReady",a)));var n={onBridgeReady:a},c=n;e.default=c},"4a27":function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",{staticClass:"uni-card"},[i("v-uni-view",{staticClass:"uni-card-header"},[i("v-uni-text",[t._v("您的报名支付费用："+t._s(t.activity.totalFee)+" 元")])],1),i("v-uni-view",{staticClass:"uni-card-content"},[i("v-uni-view",{staticClass:"uni-card-content-inner"},[i("v-uni-view",[i("v-uni-view",{staticClass:"uni-title"},[i("v-uni-text",[t._v("活动开始时间："+t._s(t.activity.startTime))])],1),i("v-uni-view",{staticClass:"uni-title"},[i("v-uni-text",[t._v("活动结束时间："+t._s(t.activity.endTime))])],1),i("v-uni-view",{staticClass:"uni-title"},[i("v-uni-text",[t._v("活动人数："+t._s(t.activity.headcountDesc))])],1),i("v-uni-view",{staticClass:"uni-title"},[i("v-uni-text",[t._v("报名费用："+t._s(t.activity.priceDesc))])],1),i("v-uni-view",{staticClass:"uni-title"},[i("v-uni-text",[t._v("活动地点："+t._s(t.activity.addr))])],1)],1),i("v-uni-view",[i("v-uni-checkbox-group",{staticClass:"uni-flex",attrs:{name:"loves"},on:{change:function(e){e=t.$handleEvent(e),t.change(e)}}},[i("v-uni-checkbox",{attrs:{value:"agreement",checked:""}}),i("v-uni-navigator",{attrs:{url:"/pages/agreement/agreement"}},[i("v-uni-text",{staticClass:"uni-link"},[t._v("活动相关协议")])],1)],1)],1)],1)],1),i("v-uni-view",{staticClass:" fh-padding-30"},[i("v-uni-button",{attrs:{disabled:!t.agreement,type:"primary",loading:t.payLoading},on:{click:function(e){e=t.$handleEvent(e),t.doPay()}}},[t._v("去支付")])],1)],1)},n=[];i.d(e,"a",function(){return a}),i.d(e,"b",function(){return n})},"4c6d":function(t,e,i){e=t.exports=i("2350")(!1),e.push([t.i,".uni-card[data-v-62684c96]{width:100%}",""])},"70ec":function(t,e,i){"use strict";var a=i("3473"),n=i.n(a);n.a},"72e4":function(t,e,i){"use strict";i.r(e);var a=i("4a27"),n=i("25d5");for(var c in n)"default"!==c&&function(t){i.d(e,t,function(){return n[t]})}(c);i("70ec");var o=i("2877"),s=Object(o["a"])(n["default"],a["a"],a["b"],!1,null,"62684c96",null);e["default"]=s.exports},dbdd:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=n(i("4722"));function n(t){return t&&t.__esModule?t:{default:t}}var c={data:function(){return{agreement:!0,payLoading:!1,activity:{id:"",totalFee:"",priceDesc:"",startTime:"",endTime:"",addr:"",headcountDesc:""},participateId:""}},onShareAppMessage:function(){var t=this;return{title:t.activity.title,path:"/pages/activity/detail?id="+t.activity.id}},onLoad:function(t){var e=this;e.activity.id=t.activityId,e.participateId=t.participateId,e.getDetail()},watch:{},methods:{change:function(t){t.detail.value.length>0?this.agreement=!0:this.agreement=!1},getDetail:function(){var t=this;t.$http.get("/wwd/activity/"+t.activity.id,{success:function(e){var i=e.data.data.content;t.activity.startTime=i.startTime,t.activity.endTime=i.endTime,t.activity.addr=i.addr;var a="";a=0==i.headcount?"不限人数":i.headcount+" 人",i.headcountDesc?t.activity.headcountDesc=a+" ("+i.headcountDesc+")":t.activity.headcountDesc=a,i.malePrice==i.femalePrice?t.activity.priceDesc=i.price+" 元/人":t.activity.priceDesc="男："+i.malePrice+" 元/人，女："+i.femalePrice+" 元/人",t.activity.totalFee="",t.$http.get("/wwd/user/current",{success:function(e){var a=e.data.data.content;"male"==a.gender?(t.activity.totalFee=i.malePrice,t.setTotalFee(i.malePrice)):"female"==a.gender?(t.activity.totalFee=i.femalePrice,t.setTotalFee(i.femalePrice)):uni.showToast({title:"未能匹配到支付金额，请确认已填写性别",icon:"none"})}})}})},doPay:function(){var t=this;if(t.agreement){var e={};e.participateId=t.participateId,e.desc="活动报名费用",e.which=t.$config.which,e.notifyUrl=t.$config.hostApi+"/wwd/activity/participate/order/success",t.payLoading||(t.payLoading=!0,t.$http.post("/wwd/activity/participate/order",{data:e,success:function(e){var i=e.data.data.content;i?a.default.onBridgeReady(i,function(e){t.payLoading=!1,"get_brand_wcpay_request:ok"==e.err_msg&&(uni.showToast({title:"支付成功",icon:"none"}),uni.navigateBack({delta:2}))}):uni.showToast({title:"未获取到预支付信息",icon:"none"})},fail:function(e){var i=e.data.code,a=e.statusCode;404==a?"wxopenid_no"==i?uni.showToast({title:"未获取到openid",icon:"none"}):"fee_no"==i?uni.showToast({title:"未能匹配到支付金额，请确认已填写性别",icon:"none"}):uni.showToast({title:"活动不存在",icon:"none"}):409==a&&"payStatus=paid"==i&&uni.showToast({title:"你已支付，请勿重复支付",icon:"none"}),t.payLoading=!1},complete:function(){}}))}else uni.showToast({title:"请同意相关活动协议后继续",icon:"none"})},setTotalFee:function(t){this.activity.totalFee=t}}};e.default=c}}]);